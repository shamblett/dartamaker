Ported by Steve Hamblett <steve.hamblett@linux.com> from the original Node.js implementation by
Glynn Bird glynn.bird@gmail.com and contributors
